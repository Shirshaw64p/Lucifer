# =============================================================================
# Lucifer — Compliance Rules Mapping
# =============================================================================
# Maps each vulnerability category to relevant controls across four
# compliance frameworks:
#   - SOC 2   (Type I & II)
#   - PCI-DSS (v4.0 Requirements)
#   - HIPAA   (45 CFR sections)
#   - ISO/IEC 27001:2022 (Annex A controls)
#
# Each entry under a framework includes:
#   control_id  — the canonical identifier
#   title       — short human-readable name
#   description — brief explanation of relevance
# =============================================================================

BROKEN_AUTH:
  soc2:
    - control_id: "CC6.1"
      title: "Logical and Physical Access Controls"
      description: "Logical access security over protected information assets."
    - control_id: "CC6.2"
      title: "User Authentication Mechanisms"
      description: "Prior to issuing system credentials, registered authorized users are required."
    - control_id: "CC6.3"
      title: "Role-Based Access and Least Privilege"
      description: "Access to protected information is restricted to authorized users."
  pci_dss:
    - control_id: "Req-8.2"
      title: "User Identification and Authentication"
      description: "Ensure proper user identification and authentication management."
    - control_id: "Req-8.3"
      title: "Multi-Factor Authentication"
      description: "Secure all individual non-console administrative access with MFA."
    - control_id: "Req-8.6"
      title: "Authentication Mechanism Management"
      description: "Other authentication mechanisms are managed appropriately."
  hipaa:
    - control_id: "§164.312(d)"
      title: "Person or Entity Authentication"
      description: "Verify the identity of persons seeking access to ePHI."
    - control_id: "§164.312(a)(1)"
      title: "Access Control"
      description: "Allow access only to authorized persons or software programs."
  iso27001:
    - control_id: "A.8.5"
      title: "Secure Authentication"
      description: "Secure log-on procedures shall be implemented."
    - control_id: "A.5.17"
      title: "Authentication Information"
      description: "Allocation and management of authentication information."
    - control_id: "A.8.2"
      title: "Privileged Access Rights"
      description: "The allocation of privileged access rights shall be restricted."

INJECTION:
  soc2:
    - control_id: "CC7.1"
      title: "Detection of Changes and Vulnerabilities"
      description: "Detection and monitoring of processing anomalies."
    - control_id: "CC8.1"
      title: "Change Management"
      description: "Changes to infrastructure and software are authorized and managed."
  pci_dss:
    - control_id: "Req-6.2"
      title: "Secure Software Development"
      description: "Bespoke and custom software is developed securely."
    - control_id: "Req-6.2.4"
      title: "Software Engineering Techniques"
      description: "Prevention of common software attacks including injection."
    - control_id: "Req-6.3"
      title: "Security Vulnerabilities Identified and Addressed"
      description: "Security vulnerabilities are identified and addressed."
  hipaa:
    - control_id: "§164.312(a)(1)"
      title: "Access Control"
      description: "Technical policies and procedures for access to ePHI."
    - control_id: "§164.312(c)(1)"
      title: "Integrity Controls"
      description: "Protect ePHI from improper alteration or destruction."
  iso27001:
    - control_id: "A.8.26"
      title: "Application Security Requirements"
      description: "Information security requirements for applications."
    - control_id: "A.8.28"
      title: "Secure Coding"
      description: "Secure coding principles shall be applied to software development."

XSS:
  soc2:
    - control_id: "CC7.1"
      title: "Detection of Changes and Vulnerabilities"
      description: "Detection and monitoring of processing anomalies."
    - control_id: "CC8.1"
      title: "Change Management"
      description: "Authorization and management of infrastructure and software changes."
  pci_dss:
    - control_id: "Req-6.2.4"
      title: "Software Engineering Techniques"
      description: "Prevention of common software attacks including XSS."
    - control_id: "Req-6.4.1"
      title: "Public-Facing Web Application Protection"
      description: "Public-facing web applications are protected against attacks."
  hipaa:
    - control_id: "§164.312(a)(1)"
      title: "Access Control"
      description: "Technical policies and procedures for access."
    - control_id: "§164.312(e)(1)"
      title: "Transmission Security"
      description: "Technical security measures for ePHI transmitted over networks."
  iso27001:
    - control_id: "A.8.26"
      title: "Application Security Requirements"
      description: "Security requirements for applications shall be identified."
    - control_id: "A.8.28"
      title: "Secure Coding"
      description: "Secure coding principles applied to development."

IDOR:
  soc2:
    - control_id: "CC6.1"
      title: "Logical and Physical Access Controls"
      description: "Logical access security over protected information assets."
    - control_id: "CC6.3"
      title: "Role-Based Access and Least Privilege"
      description: "Access restricted to authorized users."
  pci_dss:
    - control_id: "Req-7.2"
      title: "Access Control Model"
      description: "System components restrict access based on user need-to-know."
    - control_id: "Req-6.2.4"
      title: "Software Engineering Techniques"
      description: "Prevention of common software attacks."
  hipaa:
    - control_id: "§164.312(a)(1)"
      title: "Access Control"
      description: "Allow access only to authorized persons or software."
    - control_id: "§164.312(a)(2)(i)"
      title: "Unique User Identification"
      description: "Assign a unique name/number for tracking user identity."
  iso27001:
    - control_id: "A.8.3"
      title: "Information Access Restriction"
      description: "Access to information shall be restricted per access control policy."
    - control_id: "A.5.15"
      title: "Access Control"
      description: "Rules controlling physical and logical access."

BOLA:
  soc2:
    - control_id: "CC6.1"
      title: "Logical and Physical Access Controls"
      description: "Logical access security protecting information assets."
    - control_id: "CC6.3"
      title: "Role-Based Access and Least Privilege"
      description: "Access restricted to authorized users with appropriate privilege."
  pci_dss:
    - control_id: "Req-7.2"
      title: "Access Control Model"
      description: "System components restrict access based on user need-to-know."
    - control_id: "Req-6.2.4"
      title: "Software Engineering Techniques"
      description: "Prevention of common software attacks."
  hipaa:
    - control_id: "§164.312(a)(1)"
      title: "Access Control"
      description: "Technical policies and procedures for ePHI access."
    - control_id: "§164.312(a)(2)(iv)"
      title: "Encryption and Decryption"
      description: "Encrypt and decrypt ePHI where appropriate."
  iso27001:
    - control_id: "A.8.3"
      title: "Information Access Restriction"
      description: "Access to information and application functions shall be restricted."
    - control_id: "A.5.15"
      title: "Access Control"
      description: "Rules controlling physical and logical access."
    - control_id: "A.8.26"
      title: "Application Security Requirements"
      description: "Information security requirements when applications are developed."

BFLA:
  soc2:
    - control_id: "CC6.1"
      title: "Logical and Physical Access Controls"
      description: "Logical access security over protected assets."
    - control_id: "CC6.3"
      title: "Role-Based Access and Least Privilege"
      description: "Authorization restricted to level of access appropriate to job role."
  pci_dss:
    - control_id: "Req-7.1"
      title: "Restrict Access by Business Need-to-Know"
      description: "Access to system components limited to required individuals."
    - control_id: "Req-7.2"
      title: "Access Control Model"
      description: "Restrict user access based on need-to-know and least privilege."
  hipaa:
    - control_id: "§164.312(a)(1)"
      title: "Access Control"
      description: "Technical policies and procedures for access to ePHI."
    - control_id: "§164.312(a)(2)(i)"
      title: "Unique User Identification"
      description: "Assign unique identifiers for tracking user identity."
  iso27001:
    - control_id: "A.5.15"
      title: "Access Control"
      description: "Rules controlling physical and logical access."
    - control_id: "A.8.3"
      title: "Information Access Restriction"
      description: "Access restricted per access control policy."

SSRF:
  soc2:
    - control_id: "CC6.1"
      title: "Logical and Physical Access Controls"
      description: "Logical access security over protected information assets."
    - control_id: "CC6.6"
      title: "System Boundary Protection"
      description: "Restrict access to system boundaries and points of connection."
    - control_id: "CC7.2"
      title: "Monitoring of System Components"
      description: "Monitor system components for anomalous behaviour."
  pci_dss:
    - control_id: "Req-6.2.4"
      title: "Software Engineering Techniques"
      description: "Prevention of common software attacks including SSRF."
    - control_id: "Req-1.3"
      title: "Network Access Restrictions"
      description: "Network access to and from the cardholder data environment is restricted."
  hipaa:
    - control_id: "§164.312(e)(1)"
      title: "Transmission Security"
      description: "Technical security measures for ePHI transmitted over networks."
    - control_id: "§164.306(a)"
      title: "Security Standards General Rules"
      description: "Ensure confidentiality, integrity, and availability of ePHI."
  iso27001:
    - control_id: "A.8.20"
      title: "Networks Security"
      description: "Network and network services shall be secured."
    - control_id: "A.8.21"
      title: "Security of Network Services"
      description: "Security mechanisms and service levels for network services."
    - control_id: "A.8.26"
      title: "Application Security Requirements"
      description: "Info-sec requirements for applications shall be identified."

XXE:
  soc2:
    - control_id: "CC7.1"
      title: "Detection of Changes and Vulnerabilities"
      description: "Detection and monitoring of processing anomalies."
    - control_id: "CC8.1"
      title: "Change Management"
      description: "Authorization and management of infrastructure and software changes."
  pci_dss:
    - control_id: "Req-6.2.4"
      title: "Software Engineering Techniques"
      description: "Prevention of common software attacks including XXE."
    - control_id: "Req-6.3"
      title: "Security Vulnerabilities Identified and Addressed"
      description: "Security vulnerabilities are identified and addressed."
  hipaa:
    - control_id: "§164.312(c)(1)"
      title: "Integrity Controls"
      description: "Protect ePHI from improper alteration or destruction."
    - control_id: "§164.312(a)(1)"
      title: "Access Control"
      description: "Technical policies and procedures for ePHI access."
  iso27001:
    - control_id: "A.8.26"
      title: "Application Security Requirements"
      description: "Security requirements for applications shall be identified."
    - control_id: "A.8.28"
      title: "Secure Coding"
      description: "Secure coding principles applied to development."

MASS_ASSIGNMENT:
  soc2:
    - control_id: "CC6.1"
      title: "Logical and Physical Access Controls"
      description: "Logical access security over protected information assets."
    - control_id: "CC8.1"
      title: "Change Management"
      description: "Changes to infrastructure and software are authorized."
  pci_dss:
    - control_id: "Req-6.2.4"
      title: "Software Engineering Techniques"
      description: "Prevention of common software attacks."
    - control_id: "Req-6.2"
      title: "Secure Software Development"
      description: "Bespoke and custom software is developed securely."
  hipaa:
    - control_id: "§164.312(a)(1)"
      title: "Access Control"
      description: "Technical policies and procedures for ePHI access."
    - control_id: "§164.312(c)(1)"
      title: "Integrity Controls"
      description: "Protect ePHI from improper alteration or destruction."
  iso27001:
    - control_id: "A.8.28"
      title: "Secure Coding"
      description: "Secure coding principles applied to development."
    - control_id: "A.8.26"
      title: "Application Security Requirements"
      description: "Information security requirements for applications."

SENSITIVE_DATA_EXPOSURE:
  soc2:
    - control_id: "CC6.1"
      title: "Logical and Physical Access Controls"
      description: "Logical access security over protected information assets."
    - control_id: "CC6.7"
      title: "Data Classification and Handling"
      description: "Restriction and management of access to confidential data."
    - control_id: "CC6.5"
      title: "Data Disposal"
      description: "Secure disposal of confidential information."
  pci_dss:
    - control_id: "Req-3.4"
      title: "Protect Stored Account Data"
      description: "Render PAN unreadable anywhere it is stored."
    - control_id: "Req-4.2"
      title: "Protect Cardholder Data in Transit"
      description: "PAN is protected with strong cryptography during transmission."
    - control_id: "Req-3.1"
      title: "Account Data Storage Minimization"
      description: "Stored account data is kept to a minimum."
  hipaa:
    - control_id: "§164.312(a)(2)(iv)"
      title: "Encryption and Decryption"
      description: "Encrypt and decrypt ePHI."
    - control_id: "§164.312(e)(2)(ii)"
      title: "Encryption"
      description: "Encrypt ePHI whenever deemed appropriate."
    - control_id: "§164.530(c)"
      title: "Safeguards"
      description: "Safeguards to protect the privacy of PHI."
  iso27001:
    - control_id: "A.8.11"
      title: "Data Masking"
      description: "Data masking shall be used in accordance with access control policy."
    - control_id: "A.8.24"
      title: "Use of Cryptography"
      description: "Rules for effective use of cryptography shall be defined."
    - control_id: "A.5.12"
      title: "Classification of Information"
      description: "Information shall be classified according to information security needs."

SECURITY_MISCONFIGURATION:
  soc2:
    - control_id: "CC7.1"
      title: "Detection of Changes and Vulnerabilities"
      description: "Detection and monitoring of processing anomalies."
    - control_id: "CC8.1"
      title: "Change Management"
      description: "Changes to infrastructure and software are authorized and managed."
    - control_id: "CC6.8"
      title: "System Configuration"
      description: "System components configured to prevent unauthorized access."
  pci_dss:
    - control_id: "Req-2.2"
      title: "System Components Configured Securely"
      description: "System components are configured and managed securely."
    - control_id: "Req-2.2.1"
      title: "Vendor Default Accounts"
      description: "Vendor default accounts are managed securely."
    - control_id: "Req-6.3"
      title: "Security Vulnerabilities Identified and Addressed"
      description: "Security vulnerabilities identified and addressed."
  hipaa:
    - control_id: "§164.310(d)(1)"
      title: "Device and Media Controls"
      description: "Policies governing hardware and electronic media."
    - control_id: "§164.306(a)"
      title: "Security Standards General Rules"
      description: "Ensure confidentiality, integrity, and availability of ePHI."
  iso27001:
    - control_id: "A.8.9"
      title: "Configuration Management"
      description: "Configurations of hardware, software, services shall be managed."
    - control_id: "A.8.19"
      title: "Installation of Software on Operational Systems"
      description: "Procedures for installation of software on operational systems."

BROKEN_ACCESS_CONTROL:
  soc2:
    - control_id: "CC6.1"
      title: "Logical and Physical Access Controls"
      description: "Logical access security over protected information assets."
    - control_id: "CC6.2"
      title: "User Authentication Mechanisms"
      description: "System credentials and authentication mechanisms."
    - control_id: "CC6.3"
      title: "Role-Based Access and Least Privilege"
      description: "Access restricted to authorized users."
  pci_dss:
    - control_id: "Req-7.1"
      title: "Restrict Access by Business Need-to-Know"
      description: "Access limited to individuals that need it."
    - control_id: "Req-7.2"
      title: "Access Control Model"
      description: "Access restricted based on need-to-know and least privilege."
    - control_id: "Req-8.3"
      title: "Multi-Factor Authentication"
      description: "Secure all individual non-console administrative access with MFA."
  hipaa:
    - control_id: "§164.312(a)(1)"
      title: "Access Control"
      description: "Technical policies and procedures for ePHI access."
    - control_id: "§164.312(a)(2)(i)"
      title: "Unique User Identification"
      description: "Assign unique identifiers for identity tracking."
    - control_id: "§164.312(d)"
      title: "Person or Entity Authentication"
      description: "Verify identity of persons seeking access."
  iso27001:
    - control_id: "A.5.15"
      title: "Access Control"
      description: "Rules controlling physical and logical access."
    - control_id: "A.8.2"
      title: "Privileged Access Rights"
      description: "Allocation of privileged access rights shall be restricted."
    - control_id: "A.8.3"
      title: "Information Access Restriction"
      description: "Access restricted per access control policy."

CRYPTOGRAPHIC_FAILURE:
  soc2:
    - control_id: "CC6.1"
      title: "Logical and Physical Access Controls"
      description: "Logical access security including data encryption."
    - control_id: "CC6.7"
      title: "Data Classification and Handling"
      description: "Restriction and management of access to confidential data."
  pci_dss:
    - control_id: "Req-4.2"
      title: "Protect Cardholder Data in Transit"
      description: "PAN protected with strong cryptography during transmission."
    - control_id: "Req-3.5"
      title: "Cryptographic Key Management"
      description: "Account data secret and private keys are protected."
    - control_id: "Req-3.4"
      title: "Protect Stored Account Data"
      description: "Render PAN unreadable anywhere it is stored."
  hipaa:
    - control_id: "§164.312(a)(2)(iv)"
      title: "Encryption and Decryption"
      description: "Encrypt and decrypt ePHI."
    - control_id: "§164.312(e)(2)(ii)"
      title: "Encryption"
      description: "Encrypt ePHI whenever deemed appropriate."
  iso27001:
    - control_id: "A.8.24"
      title: "Use of Cryptography"
      description: "Rules for effective use of cryptography shall be defined."
    - control_id: "A.5.14"
      title: "Information Transfer"
      description: "Rules, procedures or agreements for information transfer."

CLOUD_MISCONFIGURATION:
  soc2:
    - control_id: "CC6.1"
      title: "Logical and Physical Access Controls"
      description: "Logical access security over cloud-hosted assets."
    - control_id: "CC6.6"
      title: "System Boundary Protection"
      description: "Restrict access to system boundaries and points of connection."
    - control_id: "CC7.1"
      title: "Detection of Changes and Vulnerabilities"
      description: "Detection and monitoring of anomalies."
    - control_id: "CC8.1"
      title: "Change Management"
      description: "Changes to infrastructure authorized and managed."
  pci_dss:
    - control_id: "Req-2.2"
      title: "System Components Configured Securely"
      description: "Configuration and secure management of cloud components."
    - control_id: "Req-1.2"
      title: "Network Security Controls"
      description: "Network security controls (NSCs) configured and maintained."
    - control_id: "Req-11.3"
      title: "Vulnerabilities Identified and Addressed"
      description: "External and internal vulnerabilities regularly identified."
  hipaa:
    - control_id: "§164.306(a)"
      title: "Security Standards General Rules"
      description: "Ensure confidentiality, integrity, and availability of ePHI."
    - control_id: "§164.312(a)(1)"
      title: "Access Control"
      description: "Technical access control policies."
  iso27001:
    - control_id: "A.5.23"
      title: "Information Security for Use of Cloud Services"
      description: "Cloud service use shall be managed in accordance with security requirements."
    - control_id: "A.8.9"
      title: "Configuration Management"
      description: "Configurations managed including security configurations."

NETWORK_EXPOSURE:
  soc2:
    - control_id: "CC6.6"
      title: "System Boundary Protection"
      description: "Restrict access to system boundaries and points of connection."
    - control_id: "CC7.2"
      title: "Monitoring of System Components"
      description: "Monitor system components for anomalous behaviour."
  pci_dss:
    - control_id: "Req-1.2"
      title: "Network Security Controls"
      description: "NSCs are configured and maintained."
    - control_id: "Req-1.3"
      title: "Network Access Restrictions"
      description: "Network access to and from CDE is restricted."
    - control_id: "Req-11.3"
      title: "Vulnerabilities Identified and Addressed"
      description: "External and internal vulnerabilities regularly identified."
  hipaa:
    - control_id: "§164.312(e)(1)"
      title: "Transmission Security"
      description: "Technical security measures for ePHI transmitted over networks."
    - control_id: "§164.310(b)"
      title: "Workstation Use"
      description: "Policies and procedures specifying physical attributes of workstations."
  iso27001:
    - control_id: "A.8.20"
      title: "Networks Security"
      description: "Networks and network services shall be secured."
    - control_id: "A.8.21"
      title: "Security of Network Services"
      description: "Security mechanisms, service levels for all network services."
    - control_id: "A.8.22"
      title: "Segregation of Networks"
      description: "Groups of information services, users, information systems shall be segregated."

INSUFFICIENT_LOGGING:
  soc2:
    - control_id: "CC7.1"
      title: "Detection of Changes and Vulnerabilities"
      description: "Detection and monitoring of processing anomalies."
    - control_id: "CC7.2"
      title: "Monitoring of System Components"
      description: "Monitor system components and response to anomalies."
    - control_id: "CC7.3"
      title: "Evaluation of Security Events"
      description: "Security events are evaluated and responded to."
  pci_dss:
    - control_id: "Req-10.2"
      title: "Audit Logs Implementation"
      description: "Audit logs are implemented to support detection of anomalies."
    - control_id: "Req-10.3"
      title: "Audit Log Protection"
      description: "Audit logs are protected from destruction and unauthorized modification."
    - control_id: "Req-10.4"
      title: "Audit Log Review"
      description: "Audit logs are reviewed to identify anomalies or suspicious activity."
  hipaa:
    - control_id: "§164.312(b)"
      title: "Audit Controls"
      description: "Hardware, software, and procedural mechanisms for audit trails."
    - control_id: "§164.308(a)(1)(ii)(D)"
      title: "Information System Activity Review"
      description: "Procedures to regularly review records of information system activity."
  iso27001:
    - control_id: "A.8.15"
      title: "Logging"
      description: "Logs recording activities, exceptions, faults shall be produced."
    - control_id: "A.8.16"
      title: "Monitoring Activities"
      description: "Networks, systems shall be monitored for anomalous behaviour."
    - control_id: "A.8.17"
      title: "Clock Synchronization"
      description: "Clocks of information processing systems shall be synchronized."

JWT_VULNERABILITY:
  soc2:
    - control_id: "CC6.1"
      title: "Logical and Physical Access Controls"
      description: "Logical access security over protected information assets."
    - control_id: "CC6.2"
      title: "User Authentication Mechanisms"
      description: "System credentials and authentication mechanisms."
  pci_dss:
    - control_id: "Req-8.2"
      title: "User Identification and Authentication"
      description: "Proper user identification and authentication management."
    - control_id: "Req-8.6"
      title: "Authentication Mechanism Management"
      description: "Other authentication mechanisms managed appropriately."
    - control_id: "Req-6.2.4"
      title: "Software Engineering Techniques"
      description: "Prevention of common software attacks."
  hipaa:
    - control_id: "§164.312(d)"
      title: "Person or Entity Authentication"
      description: "Verify identity of persons seeking access to ePHI."
    - control_id: "§164.312(a)(2)(iv)"
      title: "Encryption and Decryption"
      description: "Encrypt and decrypt ePHI."
  iso27001:
    - control_id: "A.8.5"
      title: "Secure Authentication"
      description: "Secure log-on procedures shall be implemented."
    - control_id: "A.8.24"
      title: "Use of Cryptography"
      description: "Rules for effective use of cryptography."

INSECURE_DESERIALIZATION:
  soc2:
    - control_id: "CC7.1"
      title: "Detection of Changes and Vulnerabilities"
      description: "Detection and monitoring of processing anomalies."
    - control_id: "CC8.1"
      title: "Change Management"
      description: "Changes to infrastructure and software authorized and managed."
  pci_dss:
    - control_id: "Req-6.2.4"
      title: "Software Engineering Techniques"
      description: "Prevention of common software attacks including deserialization."
    - control_id: "Req-6.2"
      title: "Secure Software Development"
      description: "Bespoke and custom software developed securely."
    - control_id: "Req-6.3"
      title: "Security Vulnerabilities Identified and Addressed"
      description: "Security vulnerabilities identified and addressed."
  hipaa:
    - control_id: "§164.312(c)(1)"
      title: "Integrity Controls"
      description: "Protect ePHI from improper alteration or destruction."
    - control_id: "§164.312(a)(1)"
      title: "Access Control"
      description: "Technical policies and procedures for access."
  iso27001:
    - control_id: "A.8.26"
      title: "Application Security Requirements"
      description: "Security requirements for applications shall be identified."
    - control_id: "A.8.28"
      title: "Secure Coding"
      description: "Secure coding principles applied to development."
    - control_id: "A.8.9"
      title: "Configuration Management"
      description: "Configurations shall be established, documented, maintained."
